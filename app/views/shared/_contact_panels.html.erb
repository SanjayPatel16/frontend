<% unless hide_contact_panels? %>
<div class="l-constrained">
  <div class="l-contact-panels t-contact-panels <%= 'l-contact-panels--no-border-top' if contact_panels_border_top %> <%= 'l-contact-panels--homepage' if contact_panels_homepage %>">

    <div class="l-contact-panel">
      <div class="contact-panel contact-panel__chat-<%= chat_opening_hours.status %> t-chat" id="js-chat">
        <%= heading_tag level: 2, class: 'contact-panel__heading' do %>
          <span class="icon icon--web-chat"></span><%= t('contact_panels.chat.title') %>
        <% end %>

        <p class="contact-panel__chat-javascript t-chat-javascript">
          <%= t('contact_panels.chat.javascript.description_html') %>
        </p>

        <div class="contact-panel__dynamic-content is-loading" id="js-chat-content">
          <div class="contact-panel__preloader"></div>

          <p class="contact-panel__chat-description t-chat-description" id="js-chat-description">
            <%= chat_opening_hours.description %>
            <%= '*' if translation?('contact_panels.chat.smallprint') %>
          </p>

          <div class="contact-panel__button-container" id="js-chat-cta">
            <div class="contact-panel__button button is-disabled t-chat-button">
              <%= chat_opening_hours.call_to_action %>
            </div>
          </div>
        </div>

        <%= t('contact_panels.chat.opening_times_html') %>

        <% if translation?('contact_panels.chat.smallprint') %>
          <p class="smallprint t-welsh-smallprint">* <%= t('contact_panels.chat.smallprint') %></p>
        <% end %>
      </div>
    </div>

    <div class="l-contact-panel">
      <div class="contact-panel">
        <%= heading_tag level: 2, class: 'contact-panel__heading t-contact-heading' do %>
          <span class="icon icon--call-us"></span><%= t('contact_panels.call_us.title') %>
        <% end %>

        <p class="t-contact-introduction"><%= t('contact_panels.call_us.description') %></p>

        <p>
          <a class="contact-panel__telephone t-contact-number" href="<%= t('contact.telephone_number_href') %>">
            <%= t('contact.telephone_number') %></a>
        </p>

        <%= t('contact_panels.call_us.opening_times_html') %>

        <p class="smallprint">* <%= t('contact_panels.call_us.smallprint') %></p>
      </div>
    </div>

    <div class="l-contact-panel">
      <div class="contact-panel contact-panel--last">
        <%= render 'shared/newsletter_signup' %>
      </div>
    </div>
  </div>
</div>
<% end %>

<%= content_for :javascripts do %>
  <% unless hide_contact_panels? %>
    <%= javascript_include_tag 'webchat.js' %>
    <script type='text/javascript'>
      sWODomain = '<%= ENV['WEBCHAT_DOMAIN'] %>';

      sWOImageLoaded = function() {

        <% if chat_opening_hours.open? %>

        var chatCTA = document.getElementById('js-chat-cta'),
            chatDescription = document.getElementById('js-chat-description'),
            chatContent = document.getElementById('js-chat-content');

        if (sWOImage.width == 1) {

          var sWOChatElement = document.createElement('div');
          var sWOChatElementText = document.createTextNode("<%= t('contact_panels.chat.busy.call_to_action') %>");

          sWOChatElement.className = "contact-panel__button button is-disabled t-chat-button";
          sWOChatElement.appendChild(sWOChatElementText);

          chatCTA.innerHTML = "";
          chatCTA.appendChild(sWOChatElement);
          chatDescription.innerHTML = "<%= t('contact_panels.chat.busy.description') %>";

          <% if translation?('contact_panels.chat.smallprint') %>
          chatDescription.innerHTML += '&nbsp;*';
          <% end %>

          chatContent.className = "contact-panel__dynamic-content is-loaded";

        } else {

          var sWOChatElement = document.createElement('a');
          var sWOChatElementText = document.createTextNode("<%= t('contact_panels.chat.available.call_to_action') %>");
          sWOChatElement.className = "contact-panel__button button t-chat-button";
          sWOChatElement.appendChild(sWOChatElementText);

          chatCTA.innerHTML = "";
          chatCTA.appendChild(sWOChatElement);
          chatDescription.innerHTML = "<%= t('contact_panels.chat.available.description') %>";
          chatContent.className = "contact-panel__dynamic-content is-loaded";

          <% if translation?('contact_panels.chat.smallprint') %>
          chatDescription.innerHTML += '&nbsp;*';
          <% end %>

          sWOChatElement.onclick = function() {
            window.open(sWOChatElement.href, "Chat", "width=484,height=361,scrollbars=yes,resizable=yes");
            return false;
          };

          sWOChatElement.href = sWOChatstart;
          sWOChatElement.target = "_blank";

        }

        <% end %>

      };

      if (typeof sWOTrackPage == 'function') {
        sWOTrackPage();

        <%# Track page enagagement (a visit lasting more than 30 seconds) %>
        setTimeout("sWOInvite='';sWOResponse='N';sWOPage=(sWOPage || '')+'%3Ftimer%3Dtrue';sWOTrackPage();", 30000);
      }

    </script>
  <% end %>
<% end %>
